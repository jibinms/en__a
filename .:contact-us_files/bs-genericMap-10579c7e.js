define("@widget/CONTACT/bs-genericMap-10579c7e.js",["exports","~/c/bs-_rollupPluginBabelHelpers","~/c/bs-data-aids","@wsb/guac-widget-shared@^1/lib/common/utils/form"],(function(e,t,o,a){"use strict";const s=e=>`//img1.wsimg.com/isteam/ip/static/${e}`,r="undefined"==typeof window,n="IEMobile",l="Android",i="BlackBerry",p="iPhone|iPad|iPod",c=(e=[l,i,p,n])=>!r&&e.reduce(((e,t)=>e||new RegExp(`/${t}/i`).test(navigator.userAgent)),!1),g=e=>{const t=`http://maps.google.com/maps?daddr=${e}`;window.open(t)},d=c,u=()=>c([p]),{Z_INDEX_FULL_SCREEN_OVERLAY:b}=(global.Core||guac["@wsb/guac-widget-core"]).constants.layers;class m extends(global.React||guac.react).Component{constructor(){super(...arguments),this.el=document.createElement("div"),this.el.className="x",this.mapContainer=null}componentDidMount(){const{renderMap:e}=this.props,t=document.querySelector(".device-chrome.device-chrome-mobile .viewport");Object.assign(this.el.style,{backgroundColor:"#ffffff",zIndex:b},t?{position:"absolute",left:t.style.left,right:t.style.right,top:t.style.top,bottom:t.style.bottom,width:t.style.width,height:t.style.height}:{position:"fixed",left:0,right:0,top:0,bottom:0,width:"100%",height:"100%"}),this.parentContainer=t?t.parentNode:document.body,this.parentContainer.appendChild(this.el),e(this.mapContainer)}componentWillUnmount(){this.parentContainer.removeChild(this.el)}render(){const{handleClose:e,getDirectionsLabel:t,handleGetDirections:a}=this.props,r=(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{category:"neutral",section:"overlay",style:{width:"100%",height:"100%"},"data-aid":o.D.CONTACT_MAP_MOBILE_OVERLAY},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Link,{tag:"a",style:{position:"absolute",right:"small",top:"small",cursor:"pointer",background:`url('${s("mapIcon/close.svg")}')`,zIndex:1,width:"34px",height:"34px"},onClick:e}),(global.React||guac.react).createElement("div",{ref:e=>{this.mapContainer=e},style:{width:"100%",height:"100%"}}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Button.Primary,{style:{zIndex:1,position:"absolute",bottom:"xlarger",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",width:"90%"},onClick:a,children:t,solid:!0}));return(global.ReactDOM||guac["react-dom"]).createPortal(r,this.el)}}t._(m,"propTypes",{renderMap:(global.PropTypes||guac["prop-types"]).func.isRequired,handleClose:(global.PropTypes||guac["prop-types"]).func.isRequired,handleGetDirections:(global.PropTypes||guac["prop-types"]).func.isRequired,getDirectionsLabel:(global.PropTypes||guac["prop-types"]).string.isRequired,container:(global.PropTypes||guac["prop-types"]).node.isRequired});const h=({lat:e,lon:t})=>({type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[t,e]}}]}),y=({map:e,lat:t,lon:o,isMapbox:a=!0})=>{const s=a?()=>{e.resize(),e.easeTo({center:[o,t]}),e.getSource("markers").setData(h({lat:t,lon:o}))}:()=>{e.panTo({lat:parseFloat(t,10),lng:parseFloat(o,10)})};(a?e.loaded():e&&!!e.mapUrl)?setTimeout(s,200):a&&e.on("load",s)},w=e=>{const t=u()?`http://maps.apple.com/?q=${e}`:`http://www.google.com/maps/dir//${e}`;window.location.href=t},v=e=>{if(window.google&&window.google.maps&&"function"==typeof e)return e();if(document.querySelectorAll("script[src*='maps.googleapis.com/maps/api/js']").length)return setTimeout(e,2e3);const t=document.createElement("script"),o=["https://maps.googleapis.com/maps/api/js","?client=gme-godaddycom","&channel=gc-widget-contact"].join("");t.setAttribute("src",`${o}`),t.setAttribute("async","async"),document.body.appendChild(t),t.onload=e};class M extends(global.React||guac.react).Component{render(){const{address:e,staticContent:t,isRouteMobilePreviewPublish:a,openFullScreenOverlay:s}=this.props,r={button:{position:"absolute",left:"xxlarge",top:"xsmall",width:"auto","@xs-only":{fontSize:"xsmall",left:"xsmall",maxWidth:"90%"}}};if(!a){const o=t.mapCTA,a=(0,(global.Core||guac["@wsb/guac-widget-core"]).UX2.utils.TCCLUtils.getTCCLString)({eid:"ux2.contact.get_directions.click",type:"click"});return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Button.Primary,{tag:"button","data-tccl":a,onClick:g.bind(null,e),style:r.button,solid:!0,icon:"direction",size:"small"},o)}return(global.React||guac.react).createElement("a",{onClick:s,style:r.icon,"data-aid":o.D.CONTACT_MAP_EXPAND_ICON})}}M.propTypes={address:(global.PropTypes||guac["prop-types"]).string,isRouteMobilePreviewPublish:(global.PropTypes||guac["prop-types"]).bool,staticContent:(global.PropTypes||guac["prop-types"]).object.isRequired,openFullScreenOverlay:(global.PropTypes||guac["prop-types"]).func.isRequired};const C={mapboxAccessToken:"pk.eyJ1IjoiZ29kYWRkeSIsImEiOiJjaWc5b20wcjcwczAydGFsdGxvamdvYnV0In0.JK9HuO6nAzc8BnMv6W7NBQ",mapboxStyleUrl:"mapbox://styles/godaddy/ciovyeygh0029atm6zbntgxk2"};var T={local:Object.assign({formSubmitHost:"http://contact.apps-api.instantpage.dev-secureserver.net:8400",generateUrlHost:"http://url-generator.apps.dev-secureserver.net:8080",contactsHost:"https://contacts.dev-godaddy.com"},C),development:Object.assign({formSubmitHost:"https://contact.apps-api.instantpage.dev-secureserver.net",generateUrlHost:"https://url-generator.apps.dev-secureserver.net",contactsHost:"https://contacts.dev-godaddy.com"},C),test:Object.assign({formSubmitHost:"https://contact.apps-api.instantpage.test-secureserver.net",generateUrlHost:"https://url-generator.apps.test-secureserver.net",contactsHost:"https://contacts.test-godaddy.com"},C),production:Object.assign({formSubmitHost:"https://contact.apps-api.instantpage.secureserver.net",generateUrlHost:"https://url-generator.apps.secureserver.net",contactsHost:"https://contacts.godaddy.com"},C)};const{GOOGLE_MAP_STATIC:P}=o.D;class E extends(global.React||guac.react).Component{constructor(e){super(e),this.state={staticUrl:""}}componentDidMount(){const{lat:e,lon:t,address:o}=this.props;(e&&t||o)&&this.generateUrl()}generateStyles(){return{width:"100%",height:"100%","@xs-only":{objectFit:"contain",position:"absolute"}}}generateUrl(){const{lat:e,lon:t,address:o,dimensions:a,env:s}=this.props,{height:r,width:n}=a,l=(T&&T[s]||{}).generateUrlHost;if(!l)return;const i=[`lat=${e}`,`&lon=${t}`,`&address=${o}`,`&height=${r}`,`&width=${n}`].join("");window.fetch(`${l}/v1/static-google-map?${i}`).then((e=>e.json())).then((({url:e})=>this.setState({staticUrl:e})))}render(){const{staticUrl:e}=this.state;return e?(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Image,{"data-aid":P,style:this.generateStyles(),src:e}):null}}E.propTypes={lat:(global.PropTypes||guac["prop-types"]).number,lon:(global.PropTypes||guac["prop-types"]).number,address:(global.PropTypes||guac["prop-types"]).string,dimensions:(global.PropTypes||guac["prop-types"]).object,env:(global.PropTypes||guac["prop-types"]).string},E.defaultProps={dimensions:{height:80,width:275}};class f extends(global.React||guac.react).Component{render(){const e={left:0,top:0,right:0,bottom:0,position:"absolute",display:"block",backgroundImage:`url('${s("mapIcon/mboxThumb.png")}')`,backgroundSize:"cover",backgroundPosition:"center"};return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{"data-aid":o.D.CONTACT_MAP_STATIC_REND,style:e,"data-traffic2":"pandc.vnext.edit_widget_contact.static_map.click"})}}class R extends(global.React||guac.react).Component{constructor(e){super(e),t._(this,"toggleMobileOverlay",(()=>{this.setState({showMobileOverlay:!this.state.showMobileOverlay})})),t._(this,"handleGetDirections",(()=>{const{address:e}=this.props;w(e)})),t._(this,"renderFullScreenMap",(e=>{this.generateGMap(e,!0)})),this.state={isMobile:d(),isViewPortRender:"MOBILE_RENDER_DEVICE"===e.viewDevice&&!!document.querySelector(".device-chrome"),showMobileOverlay:!1},this.generateGMap=this.generateGMap.bind(this),this.randomId=(new Date).getTime().toString(16),this.googleMap=null,this.mapContainer=null,this.currentCoords={lastLat:null,lastLon:null}}componentDidMount(){v(!this.state.isMobile&&this.generateGMap.bind(this,this.mapContainer,!1))}componentDidUpdate(e){const{lat:t,lon:o,address:a,isEditMode:s}=this.props,{isMobile:r}=this.state,{lastLat:n,lastLon:l}=this.currentCoords;t&&o&&n!==t&&l!==o&&(y({map:this.googleMap,lat:t,lon:o,isMapbox:!1}),this.currentCoords={lastLat:t,lastLon:o}),e.address===a&&(s||r)||this.generateGMap(this.mapContainer)}generateGMap(e,t=!1){const{lat:o,lon:a,zoom:s,isEditMode:r,viewDevice:n,isPublishMode:l}=this.props,{isMobile:i,isViewPortRender:p}=this.state;if(!o||!a||!window.google)return;const c={lat:parseFloat(o,10),lng:parseFloat(a,10)},g={center:c,zoom:s,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,scrollwheel:!1,fullscreenControl:!1,streetViewControl:!1,zoomControl:(t||!i||r||"DESKTOP_RENDER_DEVICE"===n)&&!p,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_TOP}};i&&!t&&(g.gestureHandling="none"),this.googleMap=new google.maps.Map(e,g),new google.maps.Marker({position:c,map:this.googleMap})}render(){const{lat:e,lon:t,zoom:a,category:s,section:r,address:n,staticContent:l,renderMode:i,isPublishMode:p,viewDevice:c,isEditMode:g,overrideOverlay:d,env:u}=this.props,{isMobile:b,isViewPortRender:h,showMobileOverlay:y}=this.state;if(!Boolean(Number(e)&&Number(t)&&Number(a)))return null;const w={shared:{left:0,top:0,right:0,bottom:0,position:"absolute",transform:"translate3d(0,0,0)"},wrapper:{display:"block",cursor:"pointer",position:"absolute !important"}},v=d||b&&!g&&"DESKTOP_RENDER_DEVICE"!==c,C=v&&!h?this.toggleMobileOverlay:(global._||guac.lodash).noop,T={address:n,staticContent:l,isRouteMobilePreviewPublish:v,openFullScreenOverlay:C};return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{category:s,section:r,style:{...w.shared,...w.wrapper}},(global.React||guac.react).createElement("div",{id:`mapContainer_${this.randomId}`,ref:e=>{this.mapContainer=e},style:w.shared,"data-aid":o.D.CONTACT_MAP_REND,onClick:C},v&&(global.React||guac.react).createElement(E,this.props)),!h&&(global.React||guac.react).createElement(M,T),y&&(global.React||guac.react).createElement(m,{getDirectionsLabel:l.mapCTA,renderMap:this.renderFullScreenMap,handleClose:this.toggleMobileOverlay,handleGetDirections:this.handleGetDirections}))}}R.propTypes={lat:(global.PropTypes||guac["prop-types"]).string,lon:(global.PropTypes||guac["prop-types"]).string,zoom:(global.PropTypes||guac["prop-types"]).number,address:(global.PropTypes||guac["prop-types"]).string,env:(global.PropTypes||guac["prop-types"]).string,category:(global.PropTypes||guac["prop-types"]).string,section:(global.PropTypes||guac["prop-types"]).string,staticContent:(global.PropTypes||guac["prop-types"]).object.isRequired,isPublishMode:(global.PropTypes||guac["prop-types"]).bool,viewDevice:(global.PropTypes||guac["prop-types"]).string,isEditMode:(global.PropTypes||guac["prop-types"]).bool,overrideOverlay:(global.PropTypes||guac["prop-types"]).bool,renderMode:(global.PropTypes||guac["prop-types"]).string},R.defaultProps={staticContent:{mapCTA:""}};const x=e=>{if(window&&window.mapboxgl)return void e();window&&window._trfq&&window._trfq.push(["cmdLogEvent","load","ux2.contact.mapbox.load",[]]);const t="//api.mapbox.com/mapbox-gl-js/v1.0.0/mapbox-gl",o=document.createElement("script");o.setAttribute("src",`${t}.js`),o.setAttribute("type","text/javascript"),o.setAttribute("async","async"),o.setAttribute("id","addmapbox-js"),o.setAttribute("crossorigin","anonymous"),document.head.appendChild(o),o.onload=()=>{const o=document.createElement("link");o.setAttribute("href",`${t}.css`),o.setAttribute("rel","stylesheet"),o.setAttribute("async","async"),o.setAttribute("id","addmapbox-css"),document.head.appendChild(o),o.onload=e}},S=({container:e,interactive:t,scrollZoom:o,lat:a,lon:s,zoom:r,accessToken:n,styleUrl:l})=>{const i=window.mapboxgl;if(!i||!i.supported())return null;if(!e)return null;const p={container:e,style:l,interactive:t,zoom:r,center:[s,a],minZoom:1.5};i.accessToken=n;const c=new i.Map(p);return o||c.scrollZoom.disable(),c.on("load",(()=>{const e={id:"markers",type:"symbol",source:{type:"geojson"},layout:{"icon-image":"marker-vnext","icon-size":1}};if(e.source.data=h({lat:a,lon:s}),c.addLayer(e),t){const e=new i.NavigationControl;c.addControl(e,"top-left")}})),c};class D extends(global.React||guac.react).Component{constructor(e){super(e),t._(this,"toggleMobileOverlay",(()=>{this.setState({showMobileOverlay:!this.state.showMobileOverlay})})),t._(this,"generateMap",(()=>{if(!this.state.generateMap)return null;const{lat:e,lon:t,zoom:o,viewDevice:a,mapboxAccessToken:s,mapboxStyleUrl:r,renderMode:n}=this.props,l=a&&a.match(/mobile/i)||n===(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.PUBLISH&&d();e&&t&&(this.glMap=S({container:this.mapContainer,interactive:!this.state.isRouteMobilePreviewPublish&&!l,scrollZoom:!1,lat:e,lon:t,zoom:o,accessToken:s,styleUrl:r}),this.glMap&&"undefined"!=typeof window&&this.putMapToGlobalSpace(this.glMap),this.state.initialized||this.setState({initialized:!0}),this.glMap&&this.setState({mapboxLoaded:!0}))})),t._(this,"renderFullScreenMap",(e=>{const{lat:t,lon:o,zoom:a,mapboxAccessToken:s,mapboxStyleUrl:r}=this.props;S({container:e,interactive:!0,lat:t,lon:o,zoom:a,scrollZoom:!0,accessToken:s,styleUrl:r})})),t._(this,"handleGetDirections",(()=>{const{address:e}=this.props;w(e)})),this.state={mapboxLoaded:!1,initialized:!1,isMobile:d(),isViewPortRender:"MOBILE_RENDER_DEVICE"===e.viewDevice&&!!document.querySelector(".device-chrome"),generateMap:!e.lazyLoadMap,showMobileOverlay:!1},this.randomId=(new Date).getTime().toString(16),this.glMap=null,this.mapContainer=null,this.onScroll=(global._||guac.lodash).throttle(this.onScroll.bind(this),250)}onScroll(){if(this.props.lazyLoadMap&&this.mapWrapper){const e=50,{top:t}=this.mapWrapper.getBoundingClientRect(),o=t-(window.innerHeight+e)<=0;o&&(this.stopListening(),this.setState({generateMap:o}))}}stopListening(){window.removeEventListener("scroll",this.onScroll,{passive:!0}),window.removeEventListener("resize",this.onScroll,{passive:!0}),this.renderContainer&&this.renderContainer.removeEventListener("scroll",this.onScroll,{passive:!0})}componentDidMount(){const{lazyLoadMap:e,renderMode:t}=this.props;e&&(window.addEventListener("scroll",this.onScroll,{passive:!0}),window.addEventListener("resize",this.onScroll,{passive:!0}),this.renderContainer=this.renderContainer||t!==(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.PUBLISH&&document.getElementById("render-container"),this.renderContainer&&this.renderContainer.addEventListener("scroll",this.onScroll,{passive:!0}),this.onScroll()),x(this.generateMap)}componentWillUnmount(){this.glMap&&(this.removeMapFromGlobalSpace(this.glMap),this.glMap.remove()),this.stopListening()}componentDidUpdate(e){if(!this.glMap)return void x(this.generateMap);const{lat:t,lon:o}=this.props;t&&o&&(t!==e.lat||o!==e.lon)&&y({map:this.glMap,lat:t,lon:o}),setTimeout(this.glMap.resize.bind(this.glMap),500)}putMapToGlobalSpace(e){window.wsb=window.wsb||{},window.wsb.contact=window.wsb.contact||{},window.wsb.contact.maps=window.wsb.contact.maps||[],window.wsb.contact.handleMapResize=window.wsb.contact.handleMapResize||function(){window.requestAnimationFrame((()=>{window.wsb.contact.maps.forEach((e=>{e.resize()}))}))},window.wsb.contact.maps.push(e)}removeMapFromGlobalSpace(e){const t=window.wsb.contact.maps,o=t.indexOf(e);-1!==o&&t.splice(o,1)}render(){const{lat:e,lon:t,zoom:a,category:s,section:r,address:n,staticContent:l,isPublishMode:i,isEditMode:p,viewDevice:c,overrideOverlay:g}=this.props,{mapboxLoaded:d,initialized:u,showMobileOverlay:b,isViewPortRender:h,isMobile:y}=this.state;if(!Boolean(Number(e)&&Number(t)&&Number(a)))return null;const w={left:0,top:0,right:0,bottom:0,position:"absolute",cursor:"pointer",display:"block"},v={position:"absolute !important"},C={transform:"translate3d(0,0,0)"},T=g||y&&!p&&"DESKTOP_RENDER_DEVICE"!==c||i&&y,P=T&&!h?this.toggleMobileOverlay:(global._||guac.lodash).noop,E={address:n,staticContent:l,isRouteMobilePreviewPublish:T,openFullScreenOverlay:P};return(global.React||guac.react).createElement("div",{ref:e=>{this.mapWrapper=e||this.mapWrapper}},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{category:s,section:r,style:{...w,...v}},(global.React||guac.react).createElement("div",{id:`mapContainer_${this.randomId}`,ref:e=>{this.mapContainer=e},style:{...w,...C},"data-aid":o.D.CONTACT_MAP_REND,onClick:P}),(global.React||guac.react).createElement(M,E),u&&!d&&(global.React||guac.react).createElement(f,null)),b&&(global.React||guac.react).createElement(m,{getDirectionsLabel:l.mapCTA,renderMap:this.renderFullScreenMap,handleClose:this.toggleMobileOverlay,handleGetDirections:this.handleGetDirections}))}}D.propTypes={lat:(global.PropTypes||guac["prop-types"]).string,lon:(global.PropTypes||guac["prop-types"]).string,zoom:(global.PropTypes||guac["prop-types"]).number,viewDevice:(global.PropTypes||guac["prop-types"]).string,address:(global.PropTypes||guac["prop-types"]).string,env:(global.PropTypes||guac["prop-types"]).string,category:(global.PropTypes||guac["prop-types"]).string,section:(global.PropTypes||guac["prop-types"]).string,mapboxAccessToken:(global.PropTypes||guac["prop-types"]).string,mapboxStyleUrl:(global.PropTypes||guac["prop-types"]).string,staticContent:(global.PropTypes||guac["prop-types"]).object.isRequired,isPublishMode:(global.PropTypes||guac["prop-types"]).bool,isEditMode:(global.PropTypes||guac["prop-types"]).bool,overrideOverlay:(global.PropTypes||guac["prop-types"]).bool,renderMode:(global.PropTypes||guac["prop-types"]).string,lazyLoadMap:(global.PropTypes||guac["prop-types"]).bool},D.defaultProps={staticContent:{mapCTA:""},lazyLoadMap:!1};var O="mapbox",_="google",A="static";class L extends(global.React||guac.react).Component{render(){const{type:e}=this.props;switch(e){case A:return(global.React||guac.react).createElement(f,null);case O:return(global.React||guac.react).createElement(D,this.props);case _:return(global.React||guac.react).createElement(R,this.props);default:return null}}}L.propTypes={type:(global.PropTypes||guac["prop-types"]).string,...R.propTypes,...D.propTypes},e.default=L,Object.defineProperty(e,"__esModule",{value:!0})})),"undefined"!=typeof window&&(window.global=window);
//# sourceMappingURL=bs-genericMap-10579c7e.js.map
